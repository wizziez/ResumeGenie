<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Enhance mobile viewport settings -->
    <meta name="viewport" content="width=device-width, maximum-scale=5.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <meta name="theme-color" content="#2b6cb0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Build Your Resume - ResumeGenie</title>
    <!-- Add preload script to prevent flash of wrong theme -->
    <script>
        // Immediately apply the correct theme on page load
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark-mode');
        }
    </script>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="mobile-fixes.css">
    <!-- Remove the banner style -->
</head>
<body>
    <!-- Remove the banner div -->
    
    <header>
        <div class="container">
            <div class="logo">
                <!-- Fix the home link with explicit styling for better mobile tap target -->
                <a href="index.html" class="home-link" aria-label="Go to homepage">
                    <h1><i class="fa-solid fa-wand-magic-sparkles"></i> <span>ResumeGenie</span></h1>
                </a>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="index.html#features">Features</a></li>
                    <li><a href="index.html#how-it-works">How It Works</a></li>
                </ul>
                <!-- Dark mode toggle will be inserted here by JavaScript -->
            </nav>
        </div>
    </header>

    <section class="form-section">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="container">
            <div class="section-header">
                <h1>Create Your Resume</h1>
                <p class="form-intro">Fill in your details below and let our AI help you create a professional resume.</p>
            </div>
            
            <div class="form-container">
                <form id="resumeForm">
                    <div class="form-progress">
                        <div class="progress-step active" data-step="personal">
                            <div class="step-icon"><i class="fas fa-user"></i></div>
                            <span>Personal Info</span>
                        </div>
                        <div class="progress-step" data-step="education">
                            <div class="step-icon"><i class="fas fa-graduation-cap"></i></div>
                            <span>Education</span>
                        </div>
                        <div class="progress-step" data-step="experience">
                            <div class="step-icon"><i class="fas fa-briefcase"></i></div>
                            <span>Experience</span>
                        </div>
                        <div class="progress-step" data-step="skills">
                            <div class="step-icon"><i class="fas fa-tools"></i></div>
                            <span>Skills</span>
                        </div>
                    </div>
                    
                    <div class="form-step active" id="personal-step">
                        <h2><i class="fas fa-user"></i> Personal Information</h2>
                        <div class="form-group">
                            <label for="fullName">Full Name</label>
                            <input type="text" id="fullName" name="fullName" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone Number</label>
                            <input type="tel" id="phone" name="phone">
                        </div>
                        <div class="form-group">
                            <label for="location">Location</label>
                            <input type="text" id="location" name="location" placeholder="City, State">
                        </div>
                        <div class="form-group">
                            <label for="linkedin">LinkedIn (optional)</label>
                            <div class="input-with-icon">
                                <i class="fab fa-linkedin"></i>
                                <input type="url" id="linkedin" name="linkedin">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="summary">Professional Summary</label>
                            <textarea id="summary" name="summary" rows="4" placeholder="Brief overview of your professional background"></textarea>
                            <small class="input-tip">A strong summary highlights your key qualifications and career goals</small>
                        </div>
                        <div class="form-buttons">
                            <button type="button" class="next-btn" data-next="education">Next: Education <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <div class="form-step" id="education-step">
                        <h2><i class="fas fa-graduation-cap"></i> Education</h2>
                        <div id="education-container">
                            <div class="education-entry">
                                <div class="entry-header">
                                    <h3>Education #1</h3>
                                </div>
                                <div class="form-group">
                                    <label for="school1">Institution Name (optional)</label>
                                    <input type="text" id="school1" name="school[]">
                                </div>
                                <div class="form-group">
                                    <label for="degree1">Degree/Certification (optional)</label>
                                    <input type="text" id="degree1" name="degree[]">
                                </div>
                                <div class="form-group">
                                    <label for="fieldOfStudy1">Field of Study</label>
                                    <input type="text" id="fieldOfStudy1" name="fieldOfStudy[]">
                                </div>
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label for="eduStartDate1">Start Date</label>
                                        <div class="input-with-icon">
                                            <i class="far fa-calendar"></i>
                                            <input type="month" id="eduStartDate1" name="eduStartDate[]">
                                        </div>
                                    </div>
                                    <div class="form-group half">
                                        <label for="eduEndDate1">End Date (or Expected)</label>
                                        <div class="input-with-icon">
                                            <i class="far fa-calendar-check"></i>
                                            <input type="month" id="eduEndDate1" name="eduEndDate[]">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="eduDescription1">Description (Achievements, GPA, etc.)</label>
                                    <textarea id="eduDescription1" name="eduDescription[]" rows="3"></textarea>
                                </div>
                            </div>
                        </div>
                        <button type="button" id="addEducation" class="add-btn"><i class="fas fa-plus"></i> Add Another Education</button>
                        <div class="form-buttons">
                            <button type="button" class="prev-btn" data-prev="personal"><i class="fas fa-arrow-left"></i> Previous</button>
                            <button type="button" class="next-btn" data-next="experience">Next: Experience <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <div class="form-step" id="experience-step">
                        <h2><i class="fas fa-briefcase"></i> Work Experience</h2>
                        <div id="experience-container">
                            <div class="experience-entry">
                                <div class="entry-header">
                                    <h3>Experience #1</h3>
                                </div>
                                <div class="form-group">
                                    <label for="company1">Company Name (optional)</label>
                                    <input type="text" id="company1" name="company[]">
                                </div>
                                <div class="form-group">
                                    <label for="position1">Job Title (optional)</label>
                                    <input type="text" id="position1" name="position[]">
                                </div>
                                <div class="form-row">
                                    <div class="form-group half">
                                        <label for="workStartDate1">Start Date</label>
                                        <div class="input-with-icon">
                                            <i class="far fa-calendar"></i>
                                            <input type="month" id="workStartDate1" name="workStartDate[]">
                                        </div>
                                    </div>
                                    <div class="form-group half">
                                        <label for="workEndDate1">End Date</label>
                                        <div class="input-with-icon">
                                            <i class="far fa-calendar-check"></i>
                                            <input type="month" id="workEndDate1" name="workEndDate[]">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="checkbox-group">
                                            <input type="checkbox" id="currentJob1" name="currentJob[]">
                                            <label for="currentJob1">I currently work here</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="jobDescription1">Job Responsibilities & Achievements</label>
                                    <textarea id="jobDescription1" name="jobDescription[]" rows="4" placeholder="Describe your responsibilities and achievements"></textarea>
                                    <small class="input-tip">Focus on accomplishments with measurable results</small>
                                </div>
                            </div>
                        </div>
                        <button type="button" id="addExperience" class="add-btn"><i class="fas fa-plus"></i> Add Another Experience</button>
                        <div class="form-buttons">
                            <button type="button" class="prev-btn" data-prev="education"><i class="fas fa-arrow-left"></i> Previous</button>
                            <button type="button" class="next-btn" data-next="skills">Next: Skills <i class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <div class="form-step" id="skills-step">
                        <h2><i class="fas fa-tools"></i> Skills & Additional Information</h2>
                        <div class="form-group">
                            <label for="skills">Skills (separate with commas)</label>
                            <div class="input-with-icon">
                                <i class="fas fa-star"></i>
                                <input type="text" id="skills" name="skills" placeholder="e.g., JavaScript, Project Management, Communication">
                            </div>
                            <small class="input-tip">Include both technical and soft skills relevant to your target role</small>
                        </div>
                        <div class="form-group">
                            <label for="languages">Languages (optional)</label>
                            <div class="input-with-icon">
                                <i class="fas fa-language"></i>
                                <input type="text" id="languages" name="languages" placeholder="e.g., English (Native), Spanish (Intermediate)">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="certifications">Certifications (optional)</label>
                            <textarea id="certifications" name="certifications" rows="3" placeholder="List any relevant certifications"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="jobTarget">Target Job Title</label>
                            <div class="input-with-icon">
                                <i class="fas fa-bullseye"></i>
                                <input type="text" id="jobTarget" name="jobTarget" placeholder="e.g., Software Engineer, Marketing Manager">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="additionalInfo">Additional Information (optional)</label>
                            <textarea id="additionalInfo" name="additionalInfo" rows="3" placeholder="Any other information you'd like to include"></textarea>
                        </div>
                        <div class="form-buttons">
                            <button type="button" class="prev-btn" data-prev="experience"><i class="fas fa-arrow-left"></i> Previous</button>
                            <!-- Fix the submit button with additional attributes for debugging -->
                            <button type="submit" id="generate-resume" class="submit-btn">
                                <i class="fas fa-magic"></i> Generate Resume
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <div id="result-section" class="result-section hidden">
        <div class="container">
            <div class="section-header">
                <h2>Your AI-Enhanced Resume</h2>
            </div>
            <div class="loading-indicator hidden">
                <div class="loader"></div>
                <p>Our AI is working on your resume...</p>
                <p id="loading-message" style="font-size: 0.9em; color: var(--text-light); margin-top: 10px;">Analyzing your information...</p>
                <!-- Add a timeout button that appears after 15 seconds -->
                <button id="timeout-action" class="cta-button" style="display: none; margin-top: 20px;">
                    <i class="fas fa-sync-alt"></i> Try Again
                </button>
            </div>
            <div class="resume-container">
                <div id="resume-preview">
                    <!-- AI-generated resume will be inserted here -->
                </div>
            </div>
            <div class="action-buttons">
                <button id="download-pdf" class="cta-button"><i class="fas fa-download"></i> Download PDF</button>
                <button id="download-word" class="secondary-button"><i class="fas fa-file-word"></i> Download Word</button>
                <button id="edit-resume" class="secondary-button"><i class="fas fa-edit"></i> Edit Information</button>
            </div>
        </div>
    </div>

    <!-- Add a debug panel that we can use to troubleshoot -->
    <div id="debug-panel" style="display: none; position: fixed; bottom: 0; right: 0; background: #f9f9f9; border: 1px solid #ccc; padding: 10px; z-index: 9999; max-height: 300px; overflow: auto;">
        <h4>Debug Info</h4>
        <div id="debug-log"></div>
        <div id="network-status" style="margin: 10px 0; padding: 5px; border-radius: 4px; background-color: #e0e0e0;">
            Network status: <span id="network-status-text">Checking...</span>
        </div>
        <button onclick="document.getElementById('debug-panel').style.display='none'">Close</button>
        <!-- Add AI Connection Status Check button -->
        <button id="check-ai-connection" class="cta-button" style="margin-top: 10px; font-size: 0.9em;">
            Check AI Connection
        </button>
        <div id="ai-connection-status" style="margin-top: 10px; padding: 8px; border-radius: 4px; background-color: #e0e0e0;">
            <!-- Status will be shown here -->
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h2><i class="fa-solid fa-wand-magic-sparkles"></i></h2>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 ResumeGenie | Powered by AI</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>

    <script>
    // Consolidated inline script for debugging and page functionality
    window.addEventListener('DOMContentLoaded', function() {
        console.log('Page loaded, checking for resume form...');
        const form = document.getElementById('resumeForm');
        if (form) {
            console.log('Resume form found!');
            form.addEventListener('submit', function(e) {
                console.log('Form submit event triggered directly from inline script');
                // Don't prevent default - let the main handler do that
            });
        } else {
            console.error('Resume form not found in document!');
        }

        // Add key press to show debug panel
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.altKey && e.key === 'd') {
                const debugPanel = document.getElementById('debug-panel');
                debugPanel.style.display = debugPanel.style.display === 'none' ? 'block' : 'none';
            }
        });

        // Check network status
        updateNetworkStatus();
        
        // Monitor for network changes
        window.addEventListener('online', updateNetworkStatus);
        window.addEventListener('offline', updateNetworkStatus);
        
        // Add keyboard shortcut to check AI connection (Alt+A)
        document.addEventListener('keydown', function(e) {
            if (e.altKey && e.key === 'a') {
                debugLog("Checking AI connection via keyboard shortcut...");
                checkAIConnection();
                document.getElementById('debug-panel').style.display = 'block';
            }
        });
    });

    // Function to add to debug log
    function debugLog(message) {
        const logDiv = document.getElementById('debug-log');
        if (logDiv) {
            const time = new Date().toLocaleTimeString();
            logDiv.innerHTML += `<div>[${time}] ${message}</div>`;
        }
        console.log(message);
    }

    // Add animated loading messages
    let loadingMessages = [
        "Analyzing your information...",
        "Crafting professional content...",
        "Optimizing for ATS systems...",
        "Structuring your resume...",
        "Finalizing your document...",
        "Almost ready..."
    ];

    let messageIndex = 0;
    let loadingInterval;

    // Start animated loading messages when the form is submitted
    document.getElementById('resumeForm').addEventListener('submit', function() {
        const loadingMessage = document.getElementById('loading-message');
        messageIndex = 0;
        
        // Clear any existing interval
        if (loadingInterval) {
            clearInterval(loadingInterval);
        }
        
        // Update message every 3 seconds
        loadingInterval = setInterval(function() {
            messageIndex = (messageIndex + 1) % loadingMessages.length;
            if (loadingMessage) {
                loadingMessage.textContent = loadingMessages[messageIndex];
            }
        }, 3000);
        
        // Set first message immediately
        if (loadingMessage) {
            loadingMessage.textContent = loadingMessages[0];
        }
        
        // Show timeout button after 15 seconds
        setTimeout(() => {
            const timeoutBtn = document.getElementById('timeout-action');
            if (timeoutBtn) {
                timeoutBtn.style.display = 'inline-block';
                timeoutBtn.addEventListener('click', function() {
                    // Clear loading interval
                    clearInterval(loadingInterval);
                    
                    // Generate a fallback resume immediately using the proper functions
                    const resumeData = collectFormData(document.getElementById('resumeForm'));
                    
                    // Use the generateDemoResume function and format it properly
                    const demoResume = generateDemoResume(resumeData);
                    const formattedResume = formatResumeHTMLSimple(demoResume);
                    
                    // Hide loading state and show result
                    document.querySelector('.loading-indicator').classList.add('hidden');
                    const resumePreview = document.getElementById('resume-preview');
                    resumePreview.innerHTML = formattedResume;
                    
                    debugLog("Used fallback resume generator due to timeout");
                });
            }
        }, 15000);
    });

    // Add keyboard shortcut to check AI connection (Ctrl+Alt+C)
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.altKey && e.key === 'c') {
            debugLog("Checking AI connection...");
            checkAIConnection();
        }
    });

    // Add network status check
    function updateNetworkStatus() {
        const statusText = document.getElementById('network-status-text');
        if (!statusText) return;
        
        if (navigator.onLine) {
            statusText.textContent = "Online";
            statusText.style.color = "green";
        } else {
            statusText.textContent = "Offline";
            statusText.style.color = "red";
            debugLog("⚠️ Network is offline - API calls will fail");
        }
    }
    </script>
</body>
</html>
